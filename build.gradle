plugins {
    id 'org.asciidoctor.convert' version '2.4.0'
    id 'org.ajoberstar.git-publish' version '2.1.1'
}

group 'demo.gitpublish'
version '1.0-SNAPSHOT'


asciidoctor {
    sourceDir = file('src')
    sources {
        include 'index.adoc'
    }
    resources {
        from(sourceDir) {
            include 'images/**'
        }
    }
    backends = ['html']
    separateOutputDirs = false
}

gitPublish {
    repoUri = 'git@github.com:ndy2/restdocs-github-publish-demo.git'
    branch = 'main'
    contents {
        from(asciidoctor.outputDir) {
            into '.'
        }
    }
}

build.dependsOn asciidoctor
gitPublishCommit.dependsOn build